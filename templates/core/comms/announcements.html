{% extends 'base.html' %}

{% block title %}Announcements{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <div class="flex items-center justify-between mb-6">
        <div>
            <h2 class="text-2xl font-bold text-ch-gold">Announcements</h2>
            <p class="text-gray-400 text-sm mt-1">Team-wide updates and information</p>
        </div>
        <a href="{% url 'announcement_create' %}" class="px-4 py-2 bg-ch-gold text-black rounded font-medium hover:bg-yellow-500 transition">
            New Announcement
        </a>
    </div>

    <div class="space-y-4">
        {% for announcement in announcements %}
        <a href="{% url 'announcement_detail' announcement.id %}"
           class="block bg-ch-dark rounded-lg p-6 hover:bg-ch-gray/80 transition
                  {% if not announcement.is_read %}border-l-4 border-ch-gold{% endif %}">
            <div class="flex items-start justify-between gap-4">
                <div class="flex-1">
                    <div class="flex items-center gap-2 mb-2">
                        {% if announcement.is_pinned %}
                        <svg class="w-4 h-4 text-ch-gold" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path>
                        </svg>
                        {% endif %}
                        {% if announcement.priority == 'urgent' %}
                        <span class="bg-red-500/20 text-red-400 text-xs px-2 py-0.5 rounded font-medium">Urgent</span>
                        {% elif announcement.priority == 'important' %}
                        <span class="bg-orange-500/20 text-orange-400 text-xs px-2 py-0.5 rounded font-medium">Important</span>
                        {% endif %}
                        {% if not announcement.is_read %}
                        <span class="bg-ch-gold/20 text-ch-gold text-xs px-2 py-0.5 rounded">New</span>
                        {% endif %}
                    </div>
                    <h3 class="text-lg font-semibold mb-2">{{ announcement.title }}</h3>
                    <p class="text-gray-400 line-clamp-3">{{ announcement.content|truncatewords:50 }}</p>
                </div>
                <div class="text-right">
                    <p class="text-sm text-gray-400">{{ announcement.created_at|timesince }} ago</p>
                </div>
            </div>
            <div class="mt-4 pt-4 border-t border-gray-700 flex items-center justify-between">
                <p class="text-sm text-gray-500">By {{ announcement.author.display_name|default:announcement.author.username }}</p>
                <span class="text-ch-gold text-sm">Read more &rarr;</span>
            </div>
        </a>
        {% empty %}
        <div class="bg-ch-dark rounded-lg p-12 text-center">
            <svg class="w-16 h-16 mx-auto mb-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"></path>
            </svg>
            <h3 class="text-xl font-semibold mb-2">No Announcements Yet</h3>
            <p class="text-gray-400 mb-4">Be the first to share something with the team.</p>
            <a href="{% url 'announcement_create' %}" class="inline-block px-4 py-2 bg-ch-gold text-black rounded font-medium hover:bg-yellow-500 transition">
                Create Announcement
            </a>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
