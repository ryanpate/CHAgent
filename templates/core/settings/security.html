{% extends 'base.html' %}

{% block title %}Security Settings{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <div class="mb-8">
        <h1 class="text-2xl font-bold text-ch-gold">Organization Settings</h1>
        <p class="text-gray-400 mt-1">Manage your organization's settings and preferences</p>
    </div>

    <!-- Settings Navigation -->
    <div class="flex gap-4 mb-6 border-b border-gray-700 pb-4">
        <a href="{% url 'org_settings' %}" class="px-4 py-2 text-gray-400 hover:text-white rounded hover:bg-ch-gray transition">
            General
        </a>
        {% if membership.can_manage_users %}
        <a href="{% url 'org_settings_members' %}" class="px-4 py-2 text-gray-400 hover:text-white rounded hover:bg-ch-gray transition">
            Team Members
        </a>
        {% endif %}
        {% if membership.can_manage_billing %}
        <a href="{% url 'org_settings_billing' %}" class="px-4 py-2 text-gray-400 hover:text-white rounded hover:bg-ch-gray transition">
            Billing
        </a>
        {% endif %}
        <a href="{% url 'security_settings' %}" class="px-4 py-2 bg-ch-gold text-black rounded font-medium">
            Security
        </a>
    </div>

    <!-- Two-Factor Authentication -->
    <div class="bg-ch-dark rounded-lg p-6">
        <h2 class="text-lg font-semibold mb-2">Two-Factor Authentication</h2>
        <p class="text-gray-400 text-sm mb-4">
            Add an extra layer of security to your account using an authenticator app.
        </p>

        {% if has_2fa %}
        <div class="flex items-center justify-between">
            <div class="flex items-center gap-2">
                <span class="inline-block w-3 h-3 bg-green-500 rounded-full"></span>
                <span class="text-green-400 font-medium">Enabled</span>
            </div>
            <form method="post" action="{% url 'totp_disable' %}" id="disable-2fa-form">
                {% csrf_token %}
                <div class="flex gap-2">
                    <input type="text" name="code" placeholder="Enter code to disable"
                           class="bg-ch-gray border border-gray-700 rounded px-3 py-2 text-sm text-white w-48 focus:outline-none focus:border-ch-gold"
                           maxlength="8" required>
                    <button type="submit"
                            class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm rounded transition">
                        Disable 2FA
                    </button>
                </div>
            </form>
        </div>
        {% else %}
        <div class="flex items-center justify-between">
            <div class="flex items-center gap-2">
                <span class="inline-block w-3 h-3 bg-gray-500 rounded-full"></span>
                <span class="text-gray-400">Not enabled</span>
            </div>
            <a href="{% url 'totp_setup' %}"
               class="px-4 py-2 bg-ch-gold text-black text-sm rounded font-medium hover:bg-yellow-500 transition">
                Enable 2FA
            </a>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
